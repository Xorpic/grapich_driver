<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <title>Профиль</title>
    <script src="https://cdn.tailwindcss.com "></script>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">

<!-- Шапка -->
<header class="bg-yellow-500 text-white p-4 flex justify-between items-center">
    <h1 class="text-2xl font-bold">МаршрутОпе</h1>
    <a href="index2.html" class="hover:text-yellow-300">На главную</a>
</header>

<!-- Контент -->
<main class="flex-grow container mx-auto p-8">
    <div class="max-w-md mx-auto bg-white rounded-lg shadow-md p-6">
        <h2 class="text-2xl font-bold mb-4 text-center">Профиль пользователя</h2>

        <!-- ФИО -->
        <label class="block mb-4">
            <span class="block mb-2 font-medium">ФИО:</span>
            <input
                    type="text"
                    id="fullName"
                    class="border border-gray-300 p-2 w-full rounded-md"
                    placeholder="Введите ваше имя"
            />
        </label>

        <!-- Телефон -->
        <label class="block mb-4">
            <span class="block mb-2 font-medium">Номер телефона:</span>
            <input
                    type="text"
                    id="phone"
                    class="border border-gray-300 p-2 w-full rounded-md"
                    placeholder="+7 (___) ___-__-__"
                    readonly
            />
            <small class="text-gray-500 mt-1 block">После +7 должно быть ровно 10 цифр</small>
        </label>

        <!-- Email (только для чтения) -->
        <label class="block mb-4">
            <span class="block mb-2 font-medium">Email:</span>
            <input
                    type="email"
                    id="email"
                    class="border border-gray-300 p-2 w-full rounded-md bg-gray-100 cursor-not-allowed"
                    readonly
            />
        </label>

        <!-- Кнопка сохранения -->
        <button
                id="saveBtn"
                disabled
                class="mt-4 w-full bg-blue-500 text-white px-4 py-2 rounded-md opacity-50 cursor-not-allowed hover:bg-blue-600 transition duration-300"
        >
            Сохранить изменения
        </button>
    </div>
</main>

<!-- Футер -->
<footer class="bg-gray-800 text-white text-center py-2 mt-auto">
    <p>
        <a href="privacy.html" class="hover:text-gray-400">Политика конфиденциальности</a>
        |
        <a href="adminChat.html" class="hover:text-gray-400">Связь с администратором</a>
    </p>
</footer>

<script>
    const fullNameInput = document.getElementById("fullName");
    const phoneInput = document.getElementById("phone");
    const emailInput = document.getElementById("email");
    const saveBtn = document.getElementById("saveBtn");

    // Загружаем данные из localStorage
    const savedData = JSON.parse(localStorage.getItem("userData")) || {};

    if (savedData.email) {
        emailInput.value = savedData.email;
    }

    if (savedData.fullName) {
        fullNameInput.value = savedData.fullName;
    }

    if (savedData.phone) {
        phoneInput.value = savedData.phone;
    }

    function validateInputs() {
        const fullName = fullNameInput.value.trim();
        const phone = phoneInput.value.replace(/\D/g, ""); // Только цифры

        if (fullName && phone.length === 10) {
            saveBtn.disabled = false;
            saveBtn.classList.remove("opacity-50", "cursor-not-allowed");
            saveBtn.classList.add("bg-blue-500", "hover:bg-blue-600", "cursor-pointer");
        } else {
            saveBtn.disabled = true;
            saveBtn.classList.add("opacity-50", "cursor-not-allowed");
            saveBtn.classList.remove("bg-blue-500", "hover:bg-blue-600", "cursor-pointer");
        }
    }

    // Обработка ввода телефона
    phoneInput.addEventListener("input", () => {
        let value = phoneInput.value;

        // Убедимся, что телефон начинается с "+7 "
        if (!value.startsWith("+7 ")) {
            value = "+7 ";
        }

        // Оставляем только цифры после "+7"
        let digits = value.replace(/\D/g, "").substring(0, 10);

        // Форматируем номер
        let formatted = "+7 ";
        if (digits.length > 0) formatted += "(" + digits.substring(0, 3);
        if (digits.length >= 3) formatted += ") " + digits.substring(3, 6);
        if (digits.length >= 6) formatted += "-" + digits.substring(6, 8);
        if (digits.length >= 8) formatted += "-" + digits.substring(8, 10);

        phoneInput.value = formatted;
        validateInputs();
    });

    // Валидация ФИО
    fullNameInput.addEventListener("input", () => {
        validateInputs();
    });

    // Сохранение данных
    saveBtn.addEventListener("click", () => {
        const fullName = fullNameInput.value.trim();
        const phone = phoneInput.value.replace(/\D/g, "");
        const email = emailInput.value;

        if (!fullName) {
            alert("Введите ФИО");
            return;
        }

        if (phone.length !== 10) {
            alert("Телефон должен содержать 10 цифр после +7");
            return;
        }

        // Сохраняем данные
        localStorage.setItem("userData", JSON.stringify({ fullName, phone: phoneInput.value, email }));
        alert("Данные успешно сохранены!");
    });

    // Проверка при загрузке страницы
    window.addEventListener("load", () => {
        validateInputs();
    });
</script>

</body>
</html>